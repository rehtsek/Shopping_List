<!DOCTYPE html>
<html>
<head>
<!-- jquery library-->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<style>
/*css style for font*/
li {font-sze:2em}
/*Create a class to notify when item has been clicked as bought or for deletion*/
.bought {color:#d3d3d3}
/* creat class called toBuy for unbought items*/
.toBuy {color:black}
</style>
</head>
<body>
New Item <input type="text" id="item"/> <br/>
Quantity <input type="text" id="quantity"/> <br/>
<input type="button" onclick="newList('testing5');">Create new List</button>
<input type="button" onclick="addItem('testing5');">+</button>
<input type="button" onclick="getList();">Show Shopping List</button>
<input type="button" onclick="getListItems('testing1');">Show List Items</button>
<input type="button" onclick="deleteItem('testing2',2);">Delete Items</button>
<input type="button" onclick="showList();">Show whole list with items</button>
<input type="button" onclick="deleteList('testing');">Delete Shopping List</button>
<input type="button" onclick="deleteItem1('testing2','id',1);">Delete Items in shopping list</button>
<input type="button" onclick="updateStatus('testing5','id',2);">Update Shopping List</button>

<script>
var data = {};
var myShoppingLists = "ekShoppingList";

//function for creating new shopping list
function newList(newList){
	//localStorage.removeItem("ekShoppingList");
	var existingEntries = JSON.parse(localStorage.getItem(myShoppingLists));
if(existingEntries == null) existingEntries = {};
	var dd = {};
	dd[newList] = [];

 $.extend(existingEntries, dd );

localStorage.setItem(myShoppingLists, JSON.stringify(existingEntries));
console.log(JSON.stringify(existingEntries));
}

//adding item to a shopping list
//require: listName
function addItem(listName){
	var existingEntries = JSON.parse(localStorage.getItem(myShoppingLists));
	var entryItem = $("#item").val();
    var entryQty = $("#quantity").val();
   var len = existingEntries[listName].length-1;
   if(len == -1){i=1}else{
    var i = existingEntries[listName][len];
	i = i.id;
	i = i+1;}
	console.log(i);
  existingEntries[listName].push(
    {id: i, item: entryItem, quantity: entryQty, status: "new"}
);

localStorage.setItem(myShoppingLists, JSON.stringify(existingEntries));
console.log(JSON.stringify(existingEntries));
}
// lists shopping list names
function getList(){
	var existingEntries = JSON.parse(localStorage.getItem(myShoppingLists));
var keys = [];
   for(var k in existingEntries) keys.push(k);

console.log(JSON.stringify(keys));
}

// lists items in shopping list name
function getListItems(listName){
	var existingEntries = JSON.parse(localStorage.getItem(myShoppingLists));
var c = existingEntries[listName];
console.log(JSON.stringify(c));
}

//updates items in shopping list
function updateStatus(listName, property, value){
	 var existingEntries = JSON.parse(localStorage.getItem(myShoppingLists));
	 $.each(existingEntries[listName], function(index, result) {

            if (result[property] == value) {
            	console.log(index);
				existingEntries[listName][index].status = "bought";
                return false;
            }

        });

    localStorage.setItem(myShoppingLists, JSON.stringify(existingEntries));
}
//delete item in shopping list
   function deleteItem(listName, index) {
   var existingEntries = JSON.parse(localStorage.getItem(myShoppingLists));
   existingEntries[listName].splice(index,1);

    localStorage.setItem(myShoppingLists, JSON.stringify(existingEntries));
	console.log(JSON.stringify(existingEntries));
}

//to-do work on item name
   function deleteItem1(listName, property, value) {
   var existingEntries = JSON.parse(localStorage.getItem(myShoppingLists));
        $.each(existingEntries[listName], function(index, result) {

            if (result[property] == value) {
            	console.log(index);
                existingEntries[listName].splice(index,1);
                return false;
            }

        });

    localStorage.setItem(myShoppingLists, JSON.stringify(existingEntries));
}
//deletes shopping list name completely
function deleteList(listName){
var existingEntries = JSON.parse(localStorage.getItem(myShoppingLists));
delete existingEntries[listName];
localStorage.setItem(myShoppingLists, JSON.stringify(existingEntries));
}

// show shopping lists created
function showList(){

	var existingEntries = JSON.parse(localStorage.getItem(myShoppingLists));
	console.log(JSON.stringify(existingEntries));
}

</script>
</body>
</html>
